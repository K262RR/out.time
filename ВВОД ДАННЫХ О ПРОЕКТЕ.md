ВВОД ДАННЫХ О ПРОЕКТЕ (для быстрого создания плана сборки LLM)**

1. **Определение проекта**
   **название проекта:** Out Time — система учёта рабочего времени сотрудников через Telegram-бот и веб-панель

**цель проекта:** Автоматизировать учёт начала и окончания рабочего дня сотрудников и сбор ежедневных отчётов через Telegram-бот, с отображением информации в веб-панели администратора.

**targetMVPFeatures:**

* Регистрация компании через email и пароль
* Приглашение сотрудников по уникальной ссылке
* Подключение сотрудников через Telegram-бот
* Утреннее уведомление в 9:00 с кнопками "Да, начинаю", "Опоздаю", "Больничный/Отпуск"
* Вечернее уведомление в 18:00 с запросом текстового отчёта
* Фиксация времени прихода и ухода
* Отправка и хранение текстовых отчётов
* Веб-панель администратора с:

  * Списком сотрудников и их статуса
  * Просмотром отчётов и экспортом в Excel
  * Настройками уведомлений (время и дни недели)

**targetUserScope:** Несколько пользователей (авторизация требуется для администратора через email и пароль; сотрудники подключаются через Telegram без авторизации)

---

фреймворк: Express.js (Backend) + React (Frontend) + Telegram Bot (Telegraf.js)
база данных: PostgreSQL
orm: Без ORM — используется raw SQL через pg (Query Builder Pattern)
uiLibrary: Tailwind CSS (без shadcn/ui, используется кастомный UI)
менеджер пакетов: npm

---

Вот блок с описанием ключевых моделей данных для MVP **Out Time**, строго по структуре промпта:

---

**имя\_модели:** Company
**поля:**

* id: серийный номер (автоинкремент)
* name: строка (255 символов)
* created\_at: отметка времени
* morning\_notification\_time: время
* evening\_notification\_time: время
* timezone: строка (50 символов)

**связи:**

* У компании есть множество пользователей (админов)
* У компании есть множество сотрудников
* У компании есть множество пригласительных ссылок

---

**имя\_модели:** User (администратор)
**поля:**

* id: серийный номер (автоинкремент)
* email: строка (уникальная, 255 символов)
* password\_hash: строка
* company\_id: внешний ключ (Company)
* created\_at: отметка времени
* last\_login: отметка времени

**связи:**

* Пользователь принадлежит компании (Company)

---

**имя\_модели:** Employee
**поля:**

* id: серийный номер (автоинкремент)
* telegram\_id: число (уникальный, 64 бит)
* name: строка (255 символов)
* company\_id: внешний ключ (Company)
* is\_active: логическое значение
* created\_at: отметка времени

**связи:**

* Сотрудник принадлежит компании
* У сотрудника есть много записей времени (TimeRecord)
* У сотрудника есть много отчётов (Report)

---

**имя\_модели:** TimeRecord
**поля:**

* id: серийный номер (автоинкремент)
* employee\_id: внешний ключ (Employee)
* date: дата
* start\_time: отметка времени
* end\_time: отметка времени
* status: строка (enum: work, sick, vacation, late)
* created\_at: отметка времени

**связи:**

* Запись принадлежит сотруднику (Employee)
* У одного сотрудника может быть только одна запись на дату (уникальность: employee\_id + date)

---

**имя\_модели:** Report
**поля:**

* id: серийный номер (автоинкремент)
* employee\_id: внешний ключ (Employee)
* date: дата
* content: текст
* created\_at: отметка времени

**связи:**

* Отчёт принадлежит сотруднику
* У одного сотрудника может быть только один отчёт на дату (уникальность: employee\_id + date)

---

**имя\_модели:** Invite
**поля:**

* id: серийный номер (автоинкремент)
* company\_id: внешний ключ (Company)
* token: UUID (уникальный)
* employee\_name: строка
* is\_used: логическое значение
* expires\_at: отметка времени
* created\_at: отметка времени
* used\_at: отметка времени

**связи:**

* Приглашение принадлежит компании

---

Вот список конечных действий **Out Time MVP** в формате для **Cursor AI**, используя REST-стиль, как в твоей архитектуре (Express + PostgreSQL, без tRPC):

---

### конечное действие: Зарегистрировать компанию

**http-метод:** POST
**путь:** `/api/auth/register`
**тело запроса:** { email: строка, password: строка, companyName: строка }
**тело ответа:** { user: объект, token: строка }

---

### конечное действие: Авторизовать администратора

**http-метод:** POST
**путь:** `/api/auth/login`
**тело запроса:** { email: строка, password: строка }
**тело ответа:** { user: объект, token: строка }

---

### конечное действие: Пригласить сотрудника

**http-метод:** POST
**путь:** `/api/employees/invite`
**тело запроса:** { name: строка }
**тело ответа:** { inviteLink: строка }

---

### конечное действие: Подключить сотрудника через Telegram

**http-метод:** POST
**путь:** `/api/bot/register`
**тело запроса:** { telegram\_id: число, name: строка, invite\_token: строка }
**тело ответа:** { employee: объект }

---

### конечное действие: Отметить начало рабочего дня

**http-метод:** POST
**путь:** `/api/bot/start-day`
**тело запроса:** { telegram\_id: число, status: строка ('work' | 'late' | 'sick' | 'vacation') }
**тело ответа:** { time\_record: объект }

---

### конечное действие: Отправить вечерний отчёт и завершить день

**http-метод:** POST
**путь:** `/api/bot/end-day`
**тело запроса:** { telegram\_id: число, content: строка }
**тело ответа:** { report: объект }

---

### конечное действие: Получить список сотрудников

**http-метод:** GET
**путь:** `/api/employees`
**тело запроса:** –
**тело ответа:** массив<EmployeeObject>

---

### конечное действие: Получить данные одного сотрудника

**http-метод:** GET
**путь:** `/api/employees/:id`
**тело запроса:** –
**тело ответа:** { employee: объект, today: объект, stats: объект }

---

### конечное действие: Получить отчёты сотрудников

**http-метод:** GET
**путь:** `/api/reports?date=&employee_id=`
**тело запроса:** –
**тело ответа:** массив<ReportObject>

---

### конечное действие: Экспортировать отчёты в Excel

**http-метод:** GET
**путь:** `/api/reports/export?date=&employee_id=`
**тело запроса:** –
**тело ответа:** файл (MIME: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)

---

### конечное действие: Получить данные для dashboard

**http-метод:** GET
**путь:** `/api/dashboard`
**тело запроса:** –
**тело ответа:** { activeToday: число, reportsToday: число, averageWorkTime: строка, lastReports: массив }

---

### конечное действие: Обновить настройки компании

**http-метод:** PUT
**путь:** `/api/settings`
**тело запроса:** { morningTime: строка, eveningTime: строка, workingDays: массив<string> }
**тело ответа:** { success: true }

---

Вот финальный блок для Cursor AI, на основе твоей архитектуры и минимального интерфейса MVP:

---

**viewDescription:**
Панель администратора со списком сотрудников в виде таблицы: отображается имя, статус (работает / отсутствует), время начала/окончания рабочего дня и наличие отчёта. Наверху — блок сводки с числом активных сотрудников, количеством сданных отчётов и средней продолжительностью дня. В интерфейсе присутствует кнопка для приглашения нового сотрудника (открывает диалог с формой ввода имени).

---

**requiredUIComponents:**

* Кнопка (Tailwind, кастомная)
* Поле ввода (Tailwind, кастомное)
* Модальное окно / диалог (Tailwind + кастомный backdrop)
* Таблица (Tailwind-стилизованная)
* Тег статуса (Tailwind: цветной label)
* Иконка копирования (Heroicons или аналогичная SVG)
* Компонент-плашка "Пусто" (для отображения, если отчётов нет)
* Лоадер / спиннер (Tailwind-based)

---

Вот список **абсолютно необходимых библиотек для работы MVP "Out Time"**:

---

**requiredLibraries:**

* `express` — основной фреймворк backend
* `pg` — драйвер PostgreSQL
* `jsonwebtoken` — генерация и верификация JWT токенов
* `bcrypt` — хэширование паролей
* `telegraf` — Telegram Bot API
* `node-cron` — планировщик уведомлений (утро/вечер)
* `cors` — CORS-поддержка
* `helmet` — базовая защита HTTP-заголовков
* `express-validator` — валидация input в API
* `exceljs` — генерация Excel-файлов для экспорта отчётов
* `react` — frontend
* `react-router-dom` — маршрутизация
* `axios` — HTTP-запросы к API
* `tailwindcss` — стилизация интерфейса
* `classNames` — условные классы в JSX
* `dotenv` — работа с переменными окружения

---

